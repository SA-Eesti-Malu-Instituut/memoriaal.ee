block vars

mixin markdown(text)
    | !{ self.md(text) }

doctype html
html(lang=self.locale)
    head
        meta(charset='utf-8')
        meta(name='viewport', content='width=device-width, initial-scale=1')
        meta(property='og:url', content='https://www.memoriaal.ee' + self.path)
        meta(property='og:title', content=self.title ? self.title + ' · ' + self.siteTitle : self.siteTitle)
        meta(property='og:image', content=self.pictures[0])

        title= self.title && self.title !== self.siteTitle ? self.title + ' · ' + self.siteTitle : self.siteTitle

        link(href='https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,700,700i,800,800i&display=swap&subset=cyrillic,cyrillic-ext,latin-ext', rel='stylesheet', type='text/css')
        link(href='/css/bootstrap.min.css', rel='stylesheet')
        link(href='/style.css', rel='stylesheet')

        block style

        script(defer, data-domain='memoriaal.ee', src='https://plausible.io/js/plausible.js')
        script.
            window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
            plausible('Host', { props: { host: window.location.host } })

    body

        #text.container-fluid.pt-3(style={ 'background-image': `url(${self.pictures[0]})` })
            #text-pagetitle.row.my-0
                h2.col-12
                    if self.siteTitle !== self.title
                        a(href=self.root)= self.siteTitle
                    else
                        br
            #text-title.row.mt-4
                h1.col-12.col-lg-8
                    a(href=self.path)= self.title
            #text-content.row.mt-5.pb-1
                block content
                    .col-12.col-md-8.col-lg-9.col-xl-6
                        .row
                            #text-text.col.py-3
                                each c, idx in self.content
                                    if c.id
                                        a.text-link.py-2.d-block(href='#' + c.id)= c.title
                                        .text-block.d-none(id=c.id, class={ 'mb-3': idx!==self.content.length-1, 'mb-0': idx===self.content.length-1 })
                                            +markdown(c.text)
                                    else
                                        .m-0(class={ 'mb-3': self.content.length > 1 })
                                            +markdown(c.text)
                    .col-12.col-md-4.col-lg-3.col-xl-3
                        .row
                            each pic in self.data.gallery
                                - var picture_file = self.gallery_folder + pic.file
                                - var picture_title = pic.title
                                - var picture_author = pic.author
                                .col-6.col-md-12
                                    a(href=picture_file, data-toggle='lightbox', data-gallery='gallery', title=picture_title)
                                        img.img-fluid(src=picture_file, alt=picture_title)
                                        .text-center
                                            span.text-muted= picture_author
                                    //- a(href=picture_file)
                                    //-     img.img-fluid(src=picture_file)
                                //- .col-6.col-md-12
                                //-     a(href=pic)
                                //-         img.img-fluid(src=pic)


        include /_templates/navigation.pug

        script(src='/js/jquery-3.3.1.min.js')
        script(src='/script.js')

        block script
